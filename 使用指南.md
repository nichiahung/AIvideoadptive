# AdaptVideo AI - 智慧影片轉換工具使用指南

## 📋 目錄

1.  [系統需求](#-系統需求)
2.  [安裝與啟動](#-安裝與啟動)
3.  [介面導覽](#-介面導覽)
4.  [核心工作流程 (全新)](#-核心工作流程-全新)
5.  [詳細功能說明](#-詳細功能說明)
6.  [故障排除](#-故障排除)
7.  [技術支援](#-技術支援)

---

## 🖥️ 系統需求

### 最低系統需求
- **作業系統**: Windows 10/11, macOS 10.15+, 或主流 Linux 發行版
- **Python**: 3.8 或更高版本
- **記憶體**: 8GB RAM
- **API 金鑰**: 需要一個有效的 `OPENAI_API_KEY` 並將其設定在 `.env` 檔案中。
- **網路**: 首次執行及 AI 分析時需要網路連線。

### 推薦系統配置
- **處理器**: Intel i5 / AMD Ryzen 5 或更高等級
- **記憶體**: 16GB RAM 或更多
- **顯示卡**: 建議使用 NVIDIA GPU 以加速影片處理
- **儲存空間**: 建議使用 SSD 固態硬碟以提升檔案讀寫速度

---

## 🚀 安裝與啟動

### 首次安裝
1.  **設定 API 金鑰**:
    - 將 ` .env.example` 檔案複製並改名為 `.env`。
    - 在 `.env` 檔案中填入您的 `OPENAI_API_KEY`。
2.  **執行安裝腳本**:
    - **Windows**: 雙擊 `start_windows.bat`。
    - **macOS/Linux**: 在終端機中執行 `./start_unix.sh`。
    此腳本會自動建立虛擬環境、安裝所有必要的 Python 套件。

### 日常啟動
- 安裝完成後，再次執行對應的啟動腳本 (`start_windows.bat` 或 `start_unix.sh`) 即可啟動服務。

### 啟動成功確認
當您在終端機看到類似以下訊息，表示服務已成功啟動：
```
✅ MoviePy 已載入，支援完整影片轉換功能
✅ OpenAI 用戶端已成功初始化。
✅ OpenCV 人臉偵測模型已載入
🚀 使用 Flask 開發伺服器啟動 (除錯模式)
 * Running on http://127.0.0.1:5001
```
此時，請在瀏覽器中開啟 `http://127.0.0.1:5001` 來使用本應用程式。

---

## 🧭 介面導覽

應用程式介面主要分為頂部的 **標題區**、中間的 **工作區** 和底部的 **狀態區**。

1.  **影片來源與資訊**:
    - **上傳區域**: 點擊或拖曳檔案來上傳新影片。
    - **影片資訊卡**: 顯示已上傳影片的詳細資訊（檔名、解析度、時長等）。
2.  **原始影片預覽**:
    - 顯示影片縮圖，並可在分析完成後進行動態預覽。
    - 下方會顯示「分析完成」狀態，讓您對流程一目了然。
3.  **轉換設定 (Tabs)**:
    - **智慧轉換 (AI)**: (推薦) 透過 AI 引導，以步驟化方式完成轉換。
    - **手動轉換**: 自行選擇模板和裁切模式，提供最大靈活性。
    - **處理歷程**: 查看此影片所有已完成的轉換結果。
4.  **轉換結果預覽**:
    - 轉換完成後，頁面下方會出現此區域。
    - **並排比較**: 以最佳化的顯示尺寸，並排比較原始影片和轉換後影片。
    - **比例分析卡**: 提供視覺化的比例變化圖示和數據。

---

## 💡 核心工作流程 (全新)

這是一個典型的使用流程，充分利用了 AdaptVideo 的智慧功能，整個過程都在「智慧轉換」分頁中完成。

### 步驟 1: 上傳影片並等待 AI 分析
- 點擊上傳區或將影片檔案拖曳至此。
- 系統會自動上傳並進行 AI 分析，您可以在下方看到進度條。
- 分析完成後，**原始影片預覽**下方會出現「✅ 分析完成」的提示。

### 步驟 2: 進入智慧轉換流程
分析完成後，介面會自動展示 AI 推薦的三步驟流程：

#### **第 1 步：選擇保護對象**
- **功能**: 告訴 AI 在轉換過程中，哪些物體是您最關心的。
- **操作**:
    - 系統會以卡片形式列出所有識別到的主要物體。
    - **支援多選**: 您可以勾選一個或多個物體。
    - **智慧中心點**: 當您選擇多個物體時，AI 會自動計算加權後的最佳中心點，確保所有重要物體都能被妥善保留。
- **提示**: 物體卡片上的圖示代表其重要性（🔥高、⭐中、💡低）。

#### **第 2 步：查看 AI 專業建議**
- **功能**: 根據您選擇的保護對象，AI 會即時更新其專業建議。
- **內容**:
    - **動態更新**: 每當您更改保護對象的選擇，此處的建議文字都會自動刷新。
    - **Markdown 格式**: 以清晰的點列式說明，解釋為何推薦某些尺寸，以及構圖上的建議。
- **進階功能：自定義分析**
    - 如果 AI 的通用建議不夠，點擊下方的「✏️ 自定義分析」按鈕。
    - 在展開的輸入框中，用自然語言描述您的具體需求（例如：「請重點保留人物臉部特寫」）。
    - 點擊「🔄 重新分析」，AI 會根據您的新指令，更新上方的專業建議。

#### **第 3 步：選擇推薦尺寸並轉換**
- **功能**: 根據 AI 的分析，選擇一個最合適的尺寸模板進行轉換。
- **操作**:
    - **點擊「預覽」**: 在每個推薦模板卡片上，點擊此按鈕可即時查看多個關鍵影格的轉換效果。
    - **點擊「開始轉換」**: 對預覽滿意後，點擊此按鈕即可啟動最終的影片轉換程序。

### 步驟 3: 查看並下載最終結果
- 轉換完成後，頁面會自動滾動到下方的「轉換結果」區域。
- **並排比較**: 您可以在此同時播放原始影片和轉換後的影片，進行最直觀的效果對比。影片的顯示尺寸經過最佳化，方便比較。
- **下載**: 點擊「📥 下載影片」按鈕即可儲存轉換好的檔案。

---

## 🎯 詳細功能說明

### 智慧轉換 (AI-Powered)

#### AI 分析核心
- **多模態 LLM (GPT-4o)**: 我們的系統使用先進的 GPT-4o 模型來「觀看」影片的數個關鍵影格，理解內容與構圖。
- **角色扮演**: 我們賦予 AI一個「專業數位戶外看板內容分析師」的角色，使其不僅是識別物體，更能從廣告行銷的角度提出專業建議。

#### 互動式 AI 建議
- **聯動更新**: 保護對象的選擇與 AI 專業建議是即時聯動的，這使得您可以快速實驗不同保護對象組合下的最佳策略。
- **上下文記憶**: 當您使用「自定義分析」時，AI 會結合您選擇的保護對象和您的文字指令，進行綜合分析，提供高度客製化的建議。

### 轉換結果比較
- **智慧顯示尺寸**: 結果預覽區不再是固定的高度，而是根據原始影片和轉換後影片的比例，動態計算顯示大小，確保兩者的顯示面積相近，使視覺比較更公平、更直觀。
- **詳細資訊標題**: 影片標題會直接顯示解析度和長寬比，例如 `原始影片 (1920×1080 • 16:9)`。
- **視覺化比例分析卡**: 在影片下方，會有一張專門的卡片，用圖形和文字清晰地展示了從原始比例到目標比例的變化情況。

### 邊界保護演算法
- 系統內建先進的邊界保護機制。無論您如何選擇，系統都會自動將裁切框保持在影片安全範圍內，**確保輸出影片永遠不會有黑邊**。

---

## 🔧 故障排除

### 常見問題及解決方案

**問題 1: 服務無法啟動**
- **檢查 `.env`**: 確認 `.env` 檔案存在且 `OPENAI_API_KEY` 已正確填寫。
- **查看日誌**: 檢查終端機的錯誤訊息，可能是網路問題或套件安裝失敗。
- **手動安裝**: 嘗試在終端機手動執行 `pip install -r requirements.txt`。

**問題 2: AI 分析失敗**
- **檢查 API 金鑰**: 確保您的 OpenAI API 金鑰有效且額度充足。
- **檢查網路**: AI 分析需要連接到 OpenAI 伺服器，請檢查您的網路連線。
- **影片內容**: 過於模糊或無明確主體的影片可能導致 AI 無法提供有效建議。

---

## 📞 技術支援

如果您遇到本文件無法解決的問題，請準備以下資訊並與我們聯繫：

1.  您的作業系統及版本。
2.  Python 的版本號。
3.  出現問題時，終端機顯示的完整錯誤訊息。
4.  您進行操作的具體步驟。

我們將盡快為您提供協助。

---

*本指南最後更新於: 2024年7月26日*

